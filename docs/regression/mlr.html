<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Termeh Shafie">
<title>28&nbsp; Multiple Linear Regression – Foundational Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../regression/reg-inf.html" rel="next">
<link href="../regression/slr.html" rel="prev">
<link href="../cover.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-6bb5ad484749947dbf006bb4d74c4af5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../regression/reg-framework.html">Regression Analysis</a></li><li class="breadcrumb-item"><a href="../regression/mlr.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Foundational Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/termehs/found-stats" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introduction/what-is-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What is Statistics?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introduction/intro-math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Unavoidable Math</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introduction/intro-surveys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Surveys: Key Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introduction/variable-class.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variable Classification</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Descriptive Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../descriptive-stats/describe-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Describing a Dataset</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../descriptive-stats/central-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Measures of Central Tendency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../descriptive-stats/dispersion-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Measures of Dispersion</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Probability Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prob-theory/prob-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prob-theory/what-is-prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">What is Probability?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prob-theory/count-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Counting Rules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prob-theory/prob-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Probability Rules</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Random Variables and Probability Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rvs-probdists/random-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rvs-probdists/discrete-dists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rvs-probdists/cont-dists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rvs-probdists/jointly-dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Jointly Distributed Random Variables</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Sampling and Sampling Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sampling-dists/sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sampling-dists/sampling-dist-mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Sampling Distributions for a Sample Mean</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sampling-dists/sampling-dist-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Sampling Distributions for a Sample Proportion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sampling-dists/clt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Central Limit Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Inferential Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../inferential/intro-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">From Probability to Statistical Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../inferential/estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../inferential/hyp-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Chi Square Tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chi2/chi2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">The Chi Square Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chi2/chi2-gof.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Goodness-of-Fit Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chi2/chi2-ind.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Testing for Independence</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Regression Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/reg-framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">The Regression Framework</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/mlr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/reg-inf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Regression Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/reg-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Categorical Variables in Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/reg-diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Residual Analysis and Model Diagnostics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">References</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/normal-table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">The Standard Normal Distribution Table</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/t-table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">The <span class="math inline">\(t\)</span> Distribution Table</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/chi2-table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">The <span class="math inline">\(\chi^2\)</span> Distribution Table</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#data-structure-for-multiple-linear-regression" id="toc-data-structure-for-multiple-linear-regression" class="nav-link active" data-scroll-target="#data-structure-for-multiple-linear-regression"><span class="header-section-number">28.1</span> Data Structure for Multiple Linear Regression</a></li>
  <li><a href="#fitting-the-multiple-linear-regression-model" id="toc-fitting-the-multiple-linear-regression-model" class="nav-link" data-scroll-target="#fitting-the-multiple-linear-regression-model"><span class="header-section-number">28.2</span> Fitting the Multiple Linear Regression Model</a></li>
  <li><a href="#decomposing-variation-in-multiple-linear-regression" id="toc-decomposing-variation-in-multiple-linear-regression" class="nav-link" data-scroll-target="#decomposing-variation-in-multiple-linear-regression"><span class="header-section-number">28.3</span> Decomposing Variation in Multiple Linear Regression</a></li>
  <li><a href="#anova-table-in-multiple-regression" id="toc-anova-table-in-multiple-regression" class="nav-link" data-scroll-target="#anova-table-in-multiple-regression"><span class="header-section-number">28.4</span> ANOVA Table in Multiple Regression</a></li>
  <li><a href="#adjusted-r%C2%B2-a-caution-against-overfitting" id="toc-adjusted-r²-a-caution-against-overfitting" class="nav-link" data-scroll-target="#adjusted-r%C2%B2-a-caution-against-overfitting"><span class="header-section-number">28.5</span> Adjusted R²: A Caution Against Overfitting</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/termehs/found-stats/edit/main/regression/mlr.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/termehs/found-stats/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../regression/reg-framework.html">Regression Analysis</a></li><li class="breadcrumb-item"><a href="../regression/mlr.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-mlr" class="quarto-section-identifier"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In earlier chapters, we worked with <strong>simple linear regression</strong>, where we modeled a response variable <span class="math inline">\(y\)</span> using a single explanatory variable <span class="math inline">\(x\)</span>. However, many real-world problems involve several factors that may simultaneously influence the outcome.</p>
<p><strong>Multiple linear regression</strong> extends the simple linear model by allowing more than one explanatory variable. In this framework, the goal is to model a dependent variable <span class="math inline">\(y\)</span> as a linear function of <span class="math inline">\(K\)</span> predictors:</p>
<p><span class="math display">\[
\hat{y} = b_0 + b_1 x_1 + b_2 x_2 + \dots + b_K x_K
\]</span></p>
<p>Each coefficient <span class="math inline">\(b_k\)</span> represents the <em>partial effect</em> of predictor <span class="math inline">\(x_k\)</span> on the response, holding all other predictors constant.</p>
<section id="motivating-example-smoking-type-and-death-rate" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="motivating-example-smoking-type-and-death-rate">Motivating Example: Smoking Type and Death Rate</h4>
<p>To understand why multiple linear regression is often necessary, consider a classic example from Cochran (1968), which examines the relationship between smoking type and death rate.</p>
<p>The study compared two groups: Pipe smokers and Cigarette smokers. The outcome of interest was the death rate, measured as the number of deaths per 1,000 person-years.</p>
<p>Let:</p>
<ul>
<li>
<span class="math inline">\(y\)</span> be the death rate (per 1,000 person-years)</li>
<li>
<span class="math inline">\(x\)</span> be a binary variable indicating smoking type: <span class="math display">\[
x =
\begin{cases}
  0 &amp; \text{if pipe smoker} \\
  1 &amp; \text{if cigarette smoker}
\end{cases}
\]</span>
</li>
</ul>
<p>We begin by fitting a simple linear regression model:</p>
<p><span class="math display">\[
\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x = 17 - 4x
\]</span></p>
<p>Interpretation:</p>
<ul>
<li>For pipe smokers (<span class="math inline">\(x = 0\)</span>), the predicted death rate is <span class="math inline">\(\hat{y} = 17\)</span>
</li>
<li>For cigarette smokers (<span class="math inline">\(x = 1\)</span>), the predicted death rate is <span class="math inline">\(\hat{y} = 13\)</span>
</li>
</ul>
<p>This model seems to suggest that <em>cigarette smokers have a lower death rate</em> than pipe smokers by 4 deaths per 1,000 person-years. But this conclusion is counterintuitive and misleading. Why would cigarette smoking appear protective?</p>
<p>The likely explanation lies in <strong>confounding</strong>; in this case, the variable <strong>age</strong>. If cigarette smokers in the sample happen to be younger on average than pipe smokers, then age (a known risk factor for mortality) could explain the apparent protective effect.</p>
<p>To account for this, we expand the model to include <strong>age</strong> as an additional predictor:</p>
<p>Let:</p>
<ul>
<li>
<span class="math inline">\(x_1\)</span> = 0 for pipe smoker, 1 for cigarette smoker</li>
<li>
<span class="math inline">\(x_2\)</span> = age (in years)</li>
</ul>
<p>We now fit a <strong>multiple linear regression</strong> model:</p>
<p><span class="math display">\[
\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \hat{\beta}_2 x_2 = 14 + 4x_1 + 10x_2
\]</span></p>
<ul>
<li>The intercept 14 represents the baseline death rate for a pipe smoker of age 0 (not directly meaningful but needed for model structure).</li>
<li>The coefficient <span class="math inline">\(\hat{\beta}_1 = 4\)</span> means that, after adjusting for age, cigarette smokers have a death rate that is 4 deaths per 1,000 person-years <em>higher</em> than pipe smokers.</li>
<li>The coefficient <span class="math inline">\(\hat{\beta}_2 = 10\)</span> means that, for each additional year of age, the death rate increases by 10 deaths per 1,000 person-years, regardless of smoking type.</li>
</ul>
<p>In the simple model, the association between smoking type and death rate appeared to suggest a protective effect of cigarette smoking. But this was due to omitting a key variable (age) which was unevenly distributed between groups.</p>
<p>By including age as an explanatory variable, the multiple regression model reveals the true relationship: that cigarette smoking is associated with higher mortality risk once age is accounted for.</p>
<p>This example highlights a critical motivation for using multiple linear regression:</p>
<blockquote class="blockquote">
<p>to adjust for confounding factors and isolate the effect of each explanatory variable on the outcome</p>
</blockquote>
</section><section id="data-structure-for-multiple-linear-regression" class="level2" data-number="28.1"><h2 data-number="28.1" class="anchored" data-anchor-id="data-structure-for-multiple-linear-regression">
<span class="header-section-number">28.1</span> Data Structure for Multiple Linear Regression</h2>
<p>In general, we work with data structured as follows: we have <span class="math inline">\(n\)</span> observations and <span class="math inline">\(K\)</span> explanatory (independent) variables. The response variable is denoted by <span class="math inline">\(y\)</span>, and the predictors by <span class="math inline">\(x_1, x_2, \dots, x_K\)</span>. Each row in the dataset corresponds to a single observation, and each column (aside from <span class="math inline">\(y\)</span>) corresponds to one predictor.</p>
<p>The data can be organized in tabular form:</p>
<p><span class="math display">\[
\begin{array}{c|cccc}
y &amp; x_1 &amp; x_2 &amp; \cdots &amp; x_K \\
\hline
y_1 &amp; x_{11} &amp; x_{21} &amp; \cdots &amp; x_{K1} \\
y_2 &amp; x_{12} &amp; x_{22} &amp; \cdots &amp; x_{K2} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
y_n &amp; x_{1n} &amp; x_{2n} &amp; \cdots &amp; x_{Kn}
\end{array}
\]</span></p>
<p>This format highlights that each outcome <span class="math inline">\(y_i\)</span> is potentially influenced by all <span class="math inline">\(K\)</span> explanatory variables in the corresponding row. Our goal in multiple linear regression is to estimate how changes in each predictor <span class="math inline">\(x_k\)</span> (for <span class="math inline">\(k = 1, \dots, K\)</span>) affect the response <span class="math inline">\(y\)</span>, while controlling for the other predictors in the model.</p>
</section><section id="fitting-the-multiple-linear-regression-model" class="level2" data-number="28.2"><h2 data-number="28.2" class="anchored" data-anchor-id="fitting-the-multiple-linear-regression-model">
<span class="header-section-number">28.2</span> Fitting the Multiple Linear Regression Model</h2>
<p>Just as before, we use the <strong>least squares method</strong> to fit a linear function to our observed data. The goal is to model the relationship between a dependent variable <span class="math inline">\(y\)</span> and multiple explanatory variables <span class="math inline">\(x_1, x_2, \dots, x_K\)</span>.</p>
<p>The general form of the model is:</p>
<p><span class="math display">\[
\hat{y} = b_0 + b_1 x_1 + b_2 x_2 + \cdots + b_K x_K
\]</span></p>
<p>Here: - <span class="math inline">\(\hat{y}\)</span> is the predicted value of the response variable, - <span class="math inline">\(b_0\)</span> is the intercept (the expected value of <span class="math inline">\(y\)</span> when all <span class="math inline">\(x_k = 0\)</span>), - <span class="math inline">\(b_1, b_2, \dots, b_K\)</span> are the estimated regression coefficients for each predictor.</p>
<p>Each observation <span class="math inline">\(i = 1, 2, \dots, n\)</span> contributes a data point <span class="math inline">\((y_i, x_{1i}, x_{2i}, \dots, x_{Ki})\)</span>. For each observation, we estimate:</p>
<p><span class="math display">\[
\hat{y}_i = b_0 + b_1 x_{1i} + b_2 x_{2i} + \cdots + b_K x_{Ki}
\]</span></p>
<p>The coefficients <span class="math inline">\(b_0, b_1, \dots, b_K\)</span> are chosen to minimize the <strong>Error Sum of Squares (SSE)</strong>, that is, the squared differences between the observed values <span class="math inline">\(y_i\)</span> and their predicted values <span class="math inline">\(\hat{y}_i\)</span>:</p>
<p><span class="math display">\[
\text{SSE} = \sum_{i=1}^n (y_i - \hat{y}_i)^2 = \sum_{i=1}^n (y_i - b_0 - b_1 x_{1i} - \cdots - b_K x_{Ki})^2
\]</span></p>
<p>This minimization ensures that the fitted line (or hyperplane in higher dimensions) is as close as possible to the observed data, in the sense of minimizing prediction error.</p>
<p>In practice, we do not solve this minimization problem by hand. Instead, statistical software (here: R) performs the computations and returns the estimated coefficients and diagnostic statistics.</p>
<p>Once the least squares estimates have been obtained, we can:</p>
<ul>
<li>Interpret the coefficients to understand the relationship between predictors and the outcome,</li>
<li>Predict new values of <span class="math inline">\(y\)</span> given new values of <span class="math inline">\(x\)</span>,</li>
<li>Assess model fit using <span class="math inline">\(R^2\)</span>, residual analysis, and hypothesis tests (<a href="reg-inf.html" class="quarto-xref"><span>Chapter 29</span></a>).</li>
</ul></section><section id="decomposing-variation-in-multiple-linear-regression" class="level2" data-number="28.3"><h2 data-number="28.3" class="anchored" data-anchor-id="decomposing-variation-in-multiple-linear-regression">
<span class="header-section-number">28.3</span> Decomposing Variation in Multiple Linear Regression</h2>
<p>Just like in simple linear regression, we can break down the total variation in the response variable y into two components:</p>
<p><span class="math display">\[
\sum_{i=1}^n (y_i - \bar{y})^2 = \sum_{i=1}^n (\hat{y}_i - \bar{y})^2 + \sum_{i=1}^n (y_i - \hat{y}_i)^2
\]</span></p>
<p>This identity leads to three important quantities:</p>
<ul>
<li><p><strong>SST</strong> (Total Sum of Squares): measures the total variation in y across all observations<br><span class="math display">\[
SST = \sum_{i=1}^n (y_i - \bar{y})^2
\]</span></p></li>
<li><p><strong>SSR</strong> (Regression Sum of Squares): variation in y explained by the model<br><span class="math display">\[
SSR = \sum_{i=1}^n (\hat{y}_i - \bar{y})^2
\]</span></p></li>
<li><p><strong>SSE</strong> (Error or Residual Sum of Squares): unexplained variation (leftover noise)<br><span class="math display">\[
SSE = \sum_{i=1}^n (y_i - \hat{y}_i)^2
\]</span></p></li>
</ul>
<p>If the model fits the data perfectly, then all predicted values match the actual values, meaning SSE = 0. On the other hand, if none of the predictors explain any variation, then SSR = 0, and all variation remains in the residuals.</p>
<p>The proportion of the total variation in y that is explained by the model is measured by the coefficient of determination:</p>
<p><span class="math display">\[
R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}
\]</span></p>
<p>This value ranges between 0 and 1. A value near 1 indicates that the model captures most of the variation in y, while a value near 0 suggests poor explanatory power.</p>
</section><section id="anova-table-in-multiple-regression" class="level2" data-number="28.4"><h2 data-number="28.4" class="anchored" data-anchor-id="anova-table-in-multiple-regression">
<span class="header-section-number">28.4</span> ANOVA Table in Multiple Regression</h2>
<p>The ANOVA (Analysis of Variance) table breaks down and summarizes these sources of variation in a structured way:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 29%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th>Source</th>
<th>Sum of Squares (SS)</th>
<th>Degrees of Freedom (df)</th>
<th>Mean Square (MS)</th>
<th>F Statistic</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td>SSR</td>
<td>K</td>
<td><span class="math inline">\(MSR = \frac{SSR}{K}\)</span></td>
<td><span class="math inline">\(F = \frac{MSR}{MSE}\)</span></td>
</tr>
<tr class="even">
<td>Residual</td>
<td>SSE</td>
<td><span class="math inline">\(n - K - 1\)</span></td>
<td><span class="math inline">\(MSE = \frac{SSE}{n - K - 1}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td>SST</td>
<td><span class="math inline">\(n - 1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Here, K is the number of explanatory variables, and n is the number of observations.</p>
<p>The F-statistic in the regression row tests whether at least one of the predictors has a non-zero effect on the response variable. A large F-value indicates that the model explains a significant portion of the variation in y. We will return to this in <a href="reg-inf.html" class="quarto-xref"><span>Chapter 29</span></a>.</p>
<p>The <strong>residual variance</strong> is the average squared error between the observed and predicted values of y. It is also referred to as the Mean Squared Error (MSE):</p>
<p><span class="math display">\[
s_e^2 = \frac{SSE}{n - K - 1}
\]</span></p>
<p>A smaller residual variance implies a better-fitting model, as it indicates that the predicted values are close to the actual observations.</p>
<section id="example-28.1-sales-in-different-districts" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="example-28.1-sales-in-different-districts">Example 28.1: Sales in Different Districts</h4>
<p>To illustrate, consider a company analyzing sales performance across eight sales districts. The response variable is:</p>
<ul>
<li>
<span class="math inline">\(y\)</span>: total sales (in millions of EUR)</li>
</ul>
<p>Two potential explanatory variables are:</p>
<ul>
<li>
<span class="math inline">\(x_1\)</span>: population size (in 100,000s of people)</li>
<li>
<span class="math inline">\(x_2\)</span>: advertising volume (in 10,000s of EUR)</li>
</ul>
<p>The data from the eight districts is summarized below:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>District</th>
<th>Sales (<span class="math inline">\(y\)</span>)</th>
<th>Population (<span class="math inline">\(x_1\)</span>)</th>
<th>Advertising (<span class="math inline">\(x_2\)</span>)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>5.4</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>2</td>
<td>3.8</td>
<td>4.2</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>10.6</td>
<td>10.0</td>
<td>9.0</td>
</tr>
<tr class="even">
<td>4</td>
<td>5.2</td>
<td>4.4</td>
<td>3.5</td>
</tr>
<tr class="odd">
<td>5</td>
<td>4.5</td>
<td>3.6</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>6</td>
<td>2.7</td>
<td>1.3</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>7</td>
<td>2.5</td>
<td>2.7</td>
<td>1.8</td>
</tr>
<tr class="even">
<td>8</td>
<td>4.5</td>
<td>3.0</td>
<td>4.7</td>
</tr>
</tbody>
</table>
<p>This example raises several important questions:</p>
<ul>
<li>How much of the variation in sales across districts can be explained by differences in population and advertising?</li>
<li>What is the expected change in sales if advertising increases, assuming the population remains constant?</li>
</ul>
<p>To answer these questions, we fit a multiple linear model to the data. The model has the form:</p>
<p><span class="math display">\[
\hat{y}_i = b_0 + b_1 x_{1i} + b_2 x_{2i} + \dots + b_K x_{Ki}
\]</span></p>
<p>Here: - <span class="math inline">\(i = 1, 2, \dots, n\)</span> indexes the observations (e.g., districts), - <span class="math inline">\(b_0\)</span> is the intercept, - <span class="math inline">\(b_1, b_2, \dots, b_K\)</span> are regression coefficients for each predictor, - <span class="math inline">\(\hat{y}_i\)</span> is the predicted value of <span class="math inline">\(y\)</span> for the <span class="math inline">\(i\)</span>-th observation.</p>
<p>Below the R output from fitting this model is shown:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = sales_df)

Residuals:
       1        2        3        4        5        6        7        8 
-0.27273 -0.43141  0.18678  0.60826 -0.40773  0.55532 -0.30926  0.07076 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   0.4301     0.3897   1.104   0.3200  
x1            0.5464     0.1625   3.362   0.0201 *
x2            0.5021     0.1825   2.752   0.0402 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4981 on 5 degrees of freedom
Multiple R-squared:  0.9724,    Adjusted R-squared:  0.9614 
F-statistic:  88.1 on 2 and 5 DF,  p-value: 0.0001265</code></pre>
</div>
</div>
<p><strong>Interpretation of the Output</strong></p>
<p>The regression output provides the following key pieces of information:</p>
<ol type="1">
<li>Estimated coefficients<br>
</li>
</ol>
<ul>
<li>Intercept (<span class="math inline">\(b_0\)</span>): the predicted sales when both population and advertising are zero. Although this scenario is outside the data range, the intercept anchors the plane in the data space.</li>
<li>Population coefficient (<span class="math inline">\(b_1\)</span>): the fitted change in sales (million EUR) for each additional 100 000 people, holding advertising constant.</li>
<li>Advertising coefficient (<span class="math inline">\(b_2\)</span>): the fitted change in sales for each additional 10 000 EUR of advertising, holding population constant.</li>
</ul>
<ol start="2" type="1">
<li>
<span class="math inline">\(R^2\)</span>$<br>
These values show the proportion of variance in sales accounted for by the two predictors.</li>
</ol>
<p>A typical pattern for this dataset is that both population and advertising are positively associated with sales, meaning districts with more people and larger advertising budgets tend to sell more. The multiple-regression framework allows us to state, for example:</p>
<blockquote class="blockquote">
<p>“After adjusting for population size, an additional 10 000 EUR in advertising is associated with an estimated increase of <span class="math inline">\(b_2\)</span> million SEK in sales.”</p>
</blockquote>
<p>Because the sample is small (<span class="math inline">\(n=8\)</span>), coefficient estimates come with substantial uncertainty. Overall, this model demonstrates how multiple predictors jointly explain the variability in sales, and how each effect is interpreted while holding the other predictor constant; the fundamental advantage of multiple linear regression.</p>
</section></section><section id="adjusted-r²-a-caution-against-overfitting" class="level2" data-number="28.5"><h2 data-number="28.5" class="anchored" data-anchor-id="adjusted-r²-a-caution-against-overfitting">
<span class="header-section-number">28.5</span> Adjusted R²: A Caution Against Overfitting</h2>
<p>When fitting a multiple linear regression model, it’s tempting to keep adding explanatory variables to increase the model’s <span class="math inline">\(R^2\)</span> — the proportion of variation in the response variable explained by the model.</p>
<p>However, there’s a caveat:<br><strong><span class="math inline">\(R^2\)</span> can never decrease</strong> when a new variable is added to the model. Even if that variable has no real relationship with the outcome, the <span class="math inline">\(R^2\)</span> will either increase or stay the same. This means a model can appear to improve in fit simply by becoming more complex, even if the added variables contribute little or nothing meaningful.</p>
<p>To account for this, we use the <strong>adjusted coefficient of determination</strong>, denoted <span class="math inline">\(R^2_{\text{adj}}\)</span>, which penalizes unnecessary complexity. It is defined as:</p>
<p><span class="math display">\[
R^2_{\text{adj}} = 1 - \frac{SSE / (n - K - 1)}{SST / (n - 1)}
\]</span></p>
<p>where: - <span class="math inline">\(SSE\)</span> is the residual sum of squares, - <span class="math inline">\(SST\)</span> is the total sum of squares, - <span class="math inline">\(n\)</span> is the number of observations, - <span class="math inline">\(K\)</span> is the number of explanatory variables (not counting the intercept).</p>
<p>The adjusted <span class="math inline">\(R^2\)</span> serves as a more reliable indicator of <em>model quality</em>, particularly when trying out different sets of predictors. While ordinary <span class="math inline">\(R^2\)</span> always increases (or stays the same) when new variables are added, the adjusted version <em>can decrease</em> if the new variable does not improve the model enough to justify the increase in complexity.</p>
<p>This makes <span class="math inline">\(R^2_{\text{adj}}\)</span> especially useful in model selection procedures, where we experiment with different subsets of variables to find a model that balances fit and simplicity.</p>
<blockquote class="blockquote">
<p>Note: Adjusted <span class="math inline">\(R^2\)</span> should <strong>not</strong> be interpreted as the proportion of variance explained in the same direct way as regular <span class="math inline">\(R^2\)</span>. It is better viewed as a corrected measure of fit that accounts for the number of predictors.</p>
</blockquote>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you’re building a regression model incrementally, i.e., adding one explanatory variable at a time, keep an eye on the adjusted <span class="math inline">\(R^2\)</span>. If it decreases when you add a new variable, this may signal that the variable isn’t contributing meaningfully to the model and could be excluded.</p>
</div>
</div>
<section id="example-28.2-synthetic-data" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="example-28.2-synthetic-data">Example 28.2: Synthetic Data</h4>
<p>We work with the constructed dataset</p>
<table class="caption-top table">
<thead><tr class="header">
<th>y</th>
<th>x₁</th>
<th>x₂</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<td>5</td>
<td>4</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>2</td>
</tr>
<tr class="even">
<td>8</td>
<td>6</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>4</td>
</tr>
<tr class="even">
<td>3</td>
<td>10</td>
<td>4</td>
</tr>
<tr class="odd">
<td>10</td>
<td>11</td>
<td>6</td>
</tr>
<tr class="even">
<td>7</td>
<td>13</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(y\)</span> is the outcome, <span class="math inline">\(x_1\)</span> the first predictor, and <span class="math inline">\(x_2\)</span> a second predictor.</p>
<p>We fit a simple regression: <span class="math inline">\(y\)</span> on <span class="math inline">\(x_1\)</span>, obtaining following output:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4656 -1.3029 -0.6971  1.7525  3.3867 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1.8348     2.1150   0.868    0.419
x1            0.4631     0.2586   1.791    0.124

Residual standard error: 2.585 on 6 degrees of freedom
Multiple R-squared:  0.3483,    Adjusted R-squared:  0.2396 
F-statistic: 3.206 on 1 and 6 DF,  p-value: 0.1236</code></pre>
</div>
</div>
<p>The simple model finds a positive slope for <span class="math inline">\(x_1\)</span>: higher <span class="math inline">\(x_1\)</span> values coincide with larger <span class="math inline">\(y\)</span> values. Visual inspection confirms the upward trend:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="mlr_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Now we fit a multiple regression: <span class="math inline">\(y\)</span> on <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, obtaning the following output:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = df)

Residuals:
       1        2        3        4        5        6        7        8 
-1.24027  1.55496  0.77724 -0.29912 -0.85457 -0.41002  0.51362 -0.04183 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   1.0355     0.8946   1.158  0.29933   
x1           -1.2223     0.3287  -3.719  0.01373 * 
x2            3.6493     0.6722   5.429  0.00287 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.078 on 5 degrees of freedom
Multiple R-squared:  0.9055,    Adjusted R-squared:  0.8677 
F-statistic: 23.95 on 2 and 5 DF,  p-value: 0.002748</code></pre>
</div>
</div>
<p>and the following plot:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="mlr_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>In the multiple-regression output, the sign of the coefficient on <span class="math inline">\(x_1\)</span> reverses: it becomes negative once <span class="math inline">\(x_2\)</span> is included. The scatterplot clarifies why: points with identical <span class="math inline">\(x_2\)</span> values form nearly parallel, upward-sloping bands, but across bands <span class="math inline">\(x_2\)</span> increases along with <span class="math inline">\(x_1\)</span>, and <span class="math inline">\(x_2\)</span> has a much stronger positive association with <span class="math inline">\(y\)</span>. That mutual rise means the simple model confounded the effect of <span class="math inline">\(x_1\)</span> with that of <span class="math inline">\(x_2\)</span>; when <span class="math inline">\(x_2\)</span> is controlled for, the adjusted relationship between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span> turns negative.</p>
<p>This example shows how omitting a relevant variable can mislead both coefficient estimates and substantive conclusions. Multiple linear regression helps disentangle each predictor’s unique contribution by holding the others constant, preventing such reversals.</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/termehs\.github\.io\/found-stats\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../regression/slr.html" class="pagination-link" aria-label="Simple Linear Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../regression/reg-inf.html" class="pagination-link" aria-label="Regression Inference">
        <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Regression Inference</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Foundational Statistics by Termeh Shafie.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/termehs/found-stats/edit/main/regression/mlr.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/termehs/found-stats/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>